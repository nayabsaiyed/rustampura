var kaliumGroupedMetaboxes={};!function(p,t,s){"use strict";p(document).ready(function(){p.extend(s,{setLoading:function(t){var e;p("#kalium-acfpro-grouped-metaboxes")[t?"addClass":"removeClass"]("is-loading")},cacheId:function(){var t;return"kalium_acfpro_gm_tab_"+acf.data.post_id},setActiveTab:function(t){"object"==typeof store&&store.enabled&&store.set(s.cacheId(),{activeTab:t})},getActiveTab:function(){if("object"==typeof store&&store.enabled){var t=store.get(s.cacheId());if(t&&"activeTab"in t)return t.activeTab}return null}});var t=function(){this.init()};t.prototype.init=function(){var o=this,t="kalium-acfpro-grouped-metaboxes";this.groupedMetaboxes=_k.groupedMetaboxes,this.currentTab="",this.$tabs=p("."+t+"-tabs"),this.$body=p("."+t+"-body"),this.$container=p("."+t+"-container"),this.postboxList=[];var e=acf.getPostboxes();p.each(e,function(t,e){var a=e.get("key");if(a in o.groupedMetaboxes){var i=o.groupedMetaboxes[a];i.isVisible=function(){return e.$el.attr("style")?!e.$el.attr("style").match(/display:\s?none/):e.isVisible()},e.set("groupedMetaboxData",i),o.postboxList.push(e)}}),this.buildTabsList(),this.toggleVisibleTabs();var a=s.getActiveTab();a&&this.setActiveTab(a,!0),o.resetCurrentTab(),this.$container.addClass("loaded"),acf.addFilter("check_screen_args",function(t){return s.setLoading(!0),t}),acf.addAction("check_screen_complete",function(t,e){o.toggleVisibleTabs(),o.resetCurrentTab(),s.setLoading(!1)})},t.prototype.buildTabsList=function(){var d=this;p.each(this.postboxList,function(t,e){var a=p('<li><a href="#"></a></li>'),i=p('<div class="tab-entry"></div>'),o=e.get("groupedMetaboxData"),s=e.get("id"),n=o.title,r=o.icon,c=a.find("a");n=n.replace(/\s\(Portfolio Type.*?\)/i,""),c.html(n),r&&c.prepend('<i class="fa fa-'+r+'"></i>'),o.$tab=a,d.$tabs.append(a),i.appendTo(d.$body),i.append(e.$el),c.on("click",function(t){t.preventDefault(),d.setActiveTab(s,!0)})})},t.prototype.toggleVisibleTabs=function(){p.each(this.postboxList,function(t,e){var a=e.get("groupedMetaboxData");a.$tab[a.isVisible()?"addClass":"removeClass"]("visible")}),this.maintainHeight()},t.prototype.maintainHeight=function(){this.$body.css("min-height",this.$tabs.outerHeight())},t.prototype.setActiveTab=function(t,e){var a=acf.getPostbox(t);if(a&&a.get("id")!==this.currentTab){var i=a.get("id"),o=a.get("groupedMetaboxData");this.$body.find(".tab-entry.active").removeClass("active"),this.$tabs.find("li.active").removeClass("active"),o.$tab.addClass("active"),a.$el.parent().addClass("active"),e&&s.setActiveTab(i),this.currentTab=i,this.maintainHeight()}},t.prototype.resetCurrentTab=function(){var o=this,i=!1;p.each(this.postboxList,function(t,e){var a=e.get("groupedMetaboxData");if(a.isVisible()&&a.$tab.hasClass("active"))return!(i=!0)}),i||p.each(this.postboxList,function(t,e){var a=e.get("id"),i;if(e.get("groupedMetaboxData").isVisible())return o.setActiveTab(a),!1})},new t})}(jQuery,window,kaliumGroupedMetaboxes),function(u,f){"use strict";u(document).ready(function(){var i=function(t){var n="kalium-acfpro-portfolio-item-type",r={"type-1":"portfolio-item-type-1.png","type-2":"portfolio-item-type-2.png","type-3":"portfolio-item-type-3.png","type-4":"portfolio-item-type-4.png","type-5":"portfolio-item-type-5.png","type-6":"portfolio-item-type-6.png","type-7":"portfolio-item-type-7.png"};for(var e in r)r[e]=_k.kaliumAssetsDir+"images/admin/"+r[e];t.addClass(n);var a=t.find(".acf-input"),c=a.find("select"),i=f.location.toString().match(/action=edit/),o=[c.val(),c.find("option:selected").html()],s=c.val(),d=u('<div class="'+n+'-images"><div class="loader"></div></div>');if(a.before(d),c.find("option").each(function(t,e){var a=u(e),i=a.val(),o=a.html(),s=u('<a href="#" class="'+n+'-option" data-value="'+i+'"><span><img src="'+r[i]+'" /></span><strong>'+o+"</strong></a>");s.find("img").on("load",function(){u(this).addClass("loaded")}),d.append(s),s.on("click",function(t){t.preventDefault(),a.prop("selected",!0).attr("selected",!0),c.trigger("change")})}),i){var p=u('<div class="'+n+'-warning"></div>');p.append("<strong>Note:</strong> You are currently using <strong>"+o[1]+"</strong> type. If you change this portfolio type you may lose/overwrite some of the current settings."),d.after(p)}var l=function(){var t=c.val();s!=t&&(d.find("."+n+"-option").removeClass("active"),d.find("."+n+'-option[data-value="'+t+'"]').addClass("active"),s=t,acf.screen.data.item_type=t,acf.screen.check(),d.addClass("is-loading"),kaliumGroupedMetaboxes.setLoading(!0),t!=o[0]?p.slideDown(300):p.slideUp(300))};c.on("change",l),d.find("."+n+'-option[data-value="'+c.val()+'"]').addClass("active"),acf.addAction("check_screen_complete",function(t,e){"item_type"in e&&(d.removeClass("is-loading"),kaliumGroupedMetaboxes.setLoading(!1))},1)},t=acf.getFields({name:"item_type"});t.length&&u.each(t,function(t,e){var a=e.$el;i(a)})})}(jQuery,window);